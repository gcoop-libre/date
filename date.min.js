function date_field_formatter_view(a,b,c,d,e,f,g){try{var h={},i=g.type;if("date_default"==i){var j=null;if(drupalgap.date_formats[g.settings.format_type]){var k=drupalgap.date_formats[g.settings.format_type];$.each(k,function(a,b){return k=b,!1}),j=k.format}else j=drupalgap.date_types[g.settings.format_type].format;j=date_format_cleanse(j,d.settings.granularity),$.each(f,function(a,b){var c="D, j F Y - g:i a",d="D, j F Y",e="g:i a",f=date_prepare(b.value),g=void 0!==b.value2;if(g){var i=date_prepare(b.value2),j=date_translate(date(d,f.getTime())),k=date_translate(date(d,i.getTime()));if("0"==date("g",i.getTime()))var l="12"+date(":i a",i.getTime());else var l=date(e,i.getTime());var m=date("g",f.getTime());if("0"==m)var m="12"+date(":i a",f.getTime());else var m=date(e,f.getTime());if(j==k)h[a]={markup:'<div class="value">'+j+" - "+m+" "+t("to")+" "+l+"</div>"};else{var n=g?t("From")+": ":"";h[a]={markup:'<div class="value">'+n+date_translate(date(c,f.getTime()))+"</div>"},h[a].markup+='<div class="value2">'+t("To")+": "+date_translate(date(c,i.getTime()))+"</div>"}}else h[a]={markup:'<div class="value">'+n+date_translate(date(c,f.getTime()))+"</div>"}})}else if("format_interval"==i){var l=g.settings.interval,m=g.settings.interval_display,n=new Date;$.each(f,function(a,b){var c=date_prepare(b.value);if("time ago"==m||"raw time ago"==m){var d=drupalgap_format_interval((n.getTime()-c.getTime())/1e3,l);"time ago"==m&&(d+=" "+t("ago")),h[a]={markup:d}}else console.log("WARNING: date_field_formatter_view - unsupported interval_display ("+m+")")})}else console.log("WARNING: date_field_formatter_view - unsupported type ("+i+")");return h}catch(o){console.log("date_field_formatter_view - "+o)}}function date_field_widget_form(a,b,c,d,e,f,g,h){try{f[g].type="hidden";var i=c.settings.todate,j=parseInt(d.widget.settings.increment),k=new Date;k.setMinutes(_date_minute_increment_adjust(j,k.getMinutes()));var l=_date_widget_check_and_set_defaults(f,g,d,i,k),m=l.value_set,n=l.value2_set;if(n&&-1==f[g].value.indexOf("|")&&(f[g].value+="|"+f[g].item.value2,f[g].attributes||(f[g].attributes={}),f[g].attributes.value=f[g].value),date_apple_device())var o=new Date,o=o.getTime()+6e4*o.getTimezoneOffset(),o=new Date(o);else var o=new Date;var p=["value"];if(empty(i)||p.push("value2"),$.each(p,function(a,b){var e=_date_get_item_and_offset(f,g,b,m,n,c),h=e.item_date,k=e.offset;if(!empty(i)){var l="value2"!=b?t("From"):t("To");f[g].children.push({markup:theme("header",{text:l+": "})})}var p=date_military(d);switch(d.widget.type){case"date_select":var q=null,r=null,s=null,u=null,v=null,w=null,x=null,y=null;$.each(c.settings.granularity,function(a,c){if(c){var e=f[g].id;"value2"==b&&(e+="2"),e+="-"+a;var i={id:e,onchange:"date_select_onchange(this, '"+f[g].id+"', '"+a+"', "+p+", "+j+", "+k+")"};switch(a){case"year":q=_date_grain_widget_year(o,d,i,m,n,h);break;case"month":r=_date_grain_widget_month(o,d,i,m,n,h);break;case"day":s=_date_grain_widget_day(o,d,i,m,n,h);break;case"hour":u=_date_grain_widget_hour(o,d,i,m,n,h,p),p||(x=_date_grain_widget_ampm(o,d,i,m,n,h,p));break;case"minute":v=_date_grain_widget_minute(o,d,i,m,n,h,b,j);break;case"second":w=_date_grain_widget_second(o,d,i,m,n,h,b);break;default:console.log("WARNING: date_field_widget_form() - unsupported grain! ("+a+")")}}});var z=date_format_widget(c,d);y=date_format_order(z),_date_grain_widgets_ux_wrap(f,g,q,r,s,u,v,w,x,y);break;case"date_popup":var A=f[g].id;"value2"==b&&(A+="2");var B=null,C=null,z=date_format_widget(c,d);if(date_has_date(c.settings.granularity)){var D=JSON.parse(JSON.stringify(c.settings.granularity));D.hour=0,D.minute=0,D.second=0;var E=date_limit_format(z,D),F="",G={id:A+"-date",readonly:"readonly",onclick:"date_popup_open(this, 'date', '"+E+"', '"+f[g].id+"', "+p+", "+j+", "+k+");"};empty(E)||(F='<div class="description">'+format_string(t("Format: {1}"),date(E))+"</div>",G.value=date(E,h.getTime())),B={prefix:theme("date_label",{title:t("Date")}),suffix:F,type:"textfield",attributes:G}}if(date_has_time(c.settings.granularity)){var H=JSON.parse(JSON.stringify(c.settings.granularity));H.year=0,H.month=0,H.day=0;var I=date_limit_format(z,H),F="",G={id:A+"-time",readonly:"readonly",onclick:"date_popup_open(this, 'time', '"+I+"', '"+f[g].id+"', "+p+", "+j+", "+k+");"};empty(I)||(F='<div class="description">'+format_string(t("Format: {1}"),date(I))+"</div>",G.value=date(I,h.getTime())),C={prefix:theme("date_label",{title:t("Time")}),suffix:F,type:"textfield",attributes:G}}B&&C&&(f[g].children.push({markup:'<div class="ui-grid-a">'}),B.prefix='<div class="ui-block-a">'+B.prefix,B.suffix+="</div>",C.prefix='<div class="ui-block-b">'+C.prefix,C.suffix+="</div>"),B&&f[g].children.push(B),C&&f[g].children.push(C),B&&C&&f[g].children.push({markup:"</div>"});break;case"date_text":default:var A=f[g].id;"value2"==b&&(A+="2");var F="",G={id:A,onblur:"date_text_onchange(this, '"+f[g].id+"', "+p+", "+j+", "+k+")"},z=date_format_widget(c,d);if(!empty(z)){F='<div class="description">'+format_string(t("Format: {1}"),date(z))+"</div>",G.value=date(z,h.getTime());var J=f[g].value.split("|");"value2"==b?J[1]=G.value:J[0]=G.value,f[g].value=J.join("|")}f[g].children.push({suffix:F,type:"textfield",attributes:G})}}),date_tz_handling_is_date(c)){var q={};$.each(drupalgap.time_zones,function(a,b){q[a]=a});var r={type:"select",options:q,title:t("Timezone"),attributes:{id:f[g].id+"-timezone"}};m&&f[g].item.timezone?r.value=f[g].item.timezone:!m&&c.settings.timezone_db&&(r.value=c.settings.timezone_db),f[g].children.push(r)}}catch(s){console.log("date_field_widget_form - "+s)}}function _date_grain_widget_year(a,b,c,d,e,f){try{var g=parseInt(a.getFullYear()),h=g;if(d&&(h=parseInt(f.getFullYear())),void 0!==b.widget.settings.text_parts&&-1!=$.inArray("year",b.widget.settings.text_parts))c.value=h,c.maxlength=4,c.onblur=c.onchange,delete c.onchange,field={prefix:theme("date_label",{title:t("Year")}),type:"textfield",attributes:c};else{var i=b.widget.settings.year_range,j=i.split(":"),k=j[0],l=!0;-1==k.indexOf("-")&&-1==k.indexOf("+")||(l=!1),l?k=parseInt(k):(-1!=k.indexOf("+")&&(k=k.replace("+","")),k=parseInt(k)+g),k||(k=g);var m=j[1],n=!0;-1==m.indexOf("-")&&-1==m.indexOf("+")||(n=!1),n?m=parseInt(m):(-1!=m.indexOf("+")&&(m=m.replace("+","")),m=parseInt(m)+g),m||(m=g);for(var o={},p=k;p<=m;p++)o[p]=p;field={prefix:theme("date_label",{title:t("Year")}),type:"date_select",value:h,attributes:c,options:o}}return field}catch(q){console.log("_date_grain_widget_year",q)}}function _date_grain_widget_month(a,b,c,d,e,f){try{var g=parseInt(a.getMonth())+1,h=g;if(d&&(h=parseInt(f.getMonth())+1),void 0!==b.widget.settings.text_parts&&-1!=$.inArray("month",b.widget.settings.text_parts))c.value=h,c.maxlength=2,c.onblur=c.onchange,delete c.onchange,field={prefix:theme("date_label",{title:t("Month")}),type:"textfield",attributes:c};else{for(var i={},j=1;j<=12;j++)i[j]=""+j;field={prefix:theme("date_label",{title:t("Month")}),type:"date_select",value:h,attributes:c,options:i}}return field}catch(k){console.log("_date_grain_widget_month",k)}}function _date_grain_widget_day(a,b,c,d,e,f){try{var g=parseInt(a.getDate()),h=g;if(d&&(h=parseInt(f.getDate())),void 0!==b.widget.settings.text_parts&&-1!=$.inArray("day",b.widget.settings.text_parts))c.value=h,c.maxlength=2,c.onblur=c.onchange,delete c.onchange,field={prefix:theme("date_label",{title:t("Day")}),type:"textfield",attributes:c};else{for(var i={},j=1;j<=31;j++)i[j]=""+j;field={prefix:theme("date_label",{title:t("Day")}),type:"date_select",value:h,attributes:c,options:i}}return field}catch(k){console.log("_date_grain_widget_day",k)}}function _date_grain_widget_hour(a,b,c,d,e,f,g){try{var h=parseInt(a.getHours()),i=h;if(d&&(i=parseInt(f.getHours())),g||(i>12?i-=12:0===i&&(i=12)),void 0!==b.widget.settings.text_parts&&-1!=$.inArray("hour",b.widget.settings.text_parts))c.value=""+i,c.maxlength=2,c.onblur=c.onchange,delete c.onchange,field={prefix:theme("date_label",{title:t("Hour")}),type:"textfield",attributes:c};else{for(var j={},k=g?23:12,l=g?0:1,m=l;m<=k;m++)j[m]=""+m;field={prefix:theme("date_label",{title:t("Hour")}),type:"date_select",value:i,attributes:c,options:j}}return field}catch(n){console.log("_date_grain_widget_hour",n)}}function _date_grain_widget_ampm(a,b,c,d,e,f,g){try{var h=parseInt(a.getHours())<12?"am":"pm";return d&&(h=parseInt(f.getHours())<12?"am":"pm"),{type:"date_select",value:h,attributes:c,options:{am:"am",pm:"pm"}}}catch(i){console.log("_date_grain_widget_day",i)}}function _date_grain_widget_minute(a,b,c,d,e,f,g,h){try{var i=parseInt(a.getMinutes()),j=i;if(d&&"value"==g?j=parseInt(f.getMinutes()):e&&"value2"==g&&(j=parseInt(f.getMinutes())),void 0!==b.widget.settings.text_parts&&-1!=$.inArray("minute",b.widget.settings.text_parts))c.value=""+j,c.maxlength=2,c.onblur=c.onchange,delete c.onchange,field={prefix:theme("date_label",{title:t("Minute")}),type:"textfield",attributes:c};else{for(var k={},l=0;l<=59;l+=h){var m=""+l;1==m.length&&(m="0"+m),k[l]=m}1!=h&&(j=_date_minute_increment_adjust(h,j)),field={prefix:theme("date_label",{title:t("Minute")}),type:"date_select",value:j,attributes:c,options:k}}return field}catch(n){console.log("_date_grain_widget_minute",n)}}function _date_grain_widget_second(a,b,c,d,e,f,g){try{var h=parseInt(a.getSeconds()),i=h;if(d&&"value"==g?i=parseInt(f.getSeconds()):e&&"value2"==g&&(i=parseInt(f.getSeconds())),void 0!==b.widget.settings.text_parts&&-1!=$.inArray("second",b.widget.settings.text_parts))c.value=""+i,c.maxlength=2,c.onblur=c.onchange,delete c.onchange,field={prefix:theme("date_label",{title:t("Second")}),type:"textfield",attributes:c};else{for(var j={},k=0;k<=59;k++){var l=""+k;1==l.length&&(l="0"+l),j[k]=l}field={prefix:theme("date_label",{title:t("Second")}),type:"date_select",value:i,attributes:c,options:j}}return field}catch(m){console.log("_date_grain_widget_second",m)}}function _date_grain_widgets_ux_wrap(a,b,c,d,e,f,g,h,j,k){try{if(void 0===k)var k=["year","month","day","hour","minute","second"];var l=["ui-block-a","ui-block-b","ui-block-c"],m=null;d&&!e?m="ui-grid-a":d&&e&&(m="ui-grid-b"),m&&a[b].children.push({markup:'<div class="'+m+'">'});var n=0;for(i=0;i<k.length;i++)switch(k[i]){case"year":c&&(m&&(c.prefix='<div class="'+l[n]+'">'+c.prefix,c.suffix="</div>"),a[b].children.push(c),n++);break;case"month":d&&(d.prefix='<div class="'+l[n]+'">'+d.prefix,d.suffix="</div>",a[b].children.push(d),n++);break;case"day":e&&(e.prefix='<div class="'+l[n]+'">'+e.prefix,e.suffix="</div>",a[b].children.push(e),n++)}m&&a[b].children.push({markup:"</div>"});var o=null;f&&g&&!h?o="ui-grid-a":g&&h&&(o="ui-grid-b"),o&&a[b].children.push({markup:'<div class="'+o+'">'});var n=0;for(i=0;i<k.length;i++)switch(k[i]){case"hour":f&&(o&&(f.prefix='<div class="'+l[n]+'">'+f.prefix,f.suffix="</div>"),a[b].children.push(f),n++);break;case"minute":g&&(o&&(g.prefix='<div class="'+l[n]+'">'+g.prefix,g.suffix="</div>"),a[b].children.push(g),n++);break;case"second":h&&(o&&(h.prefix='<div class="'+l[n]+'">'+h.prefix,h.suffix="</div>"),a[b].children.push(h),n++)}o&&a[b].children.push({markup:"</div>"}),j&&a[b].children.push(j)}catch(p){console.log("_date_grain_widgets_ux_wrap",p)}}function date_prepare(a,b){try{date_apple_device()&&(a=date_apple_cleanse(a));var c=a.replace(/-/g,"/");if(date_apple_device()){var d=c.split(/[^0-9]/);return new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])}return new Date(Date.parse(c))}catch(e){console.log("date_prepare() - "+e)}}function date_format_widget(a,b){try{var c="";return void 0!==b.widget.settings.input_format&&(c=b.widget.settings.input_format,"site-wide"==c&&(c=drupalgap.date_types.short.format),c=date_limit_format(c,a.settings.granularity)),c}catch(d){console.log("date_format_widget() - "+d)}}function date_limit_format(a,b){try{return a=a.replace(/\\-/g,"-"),a=a.replace(/\\:/g,":"),a=a.replace(/\\'/g,"'"),a=a.replace(/\\. /g," . "),a=a.replace(/\\,/g,","),date_has_time(b)&&date_has_date(b)||(a=a.replace(/\\T/g," "),a=a.replace(/T/g," ")),reversed_format=a.split("").reverse().join(""),date_has_time(b)||(reversed_format=reversed_format.replace(/([a|A](?!\\\\))/g,"")),(void 0===b.year||empty(b.year))&&(reversed_format=reversed_format.replace(/([Yy](?!\\\\)\s?[\-\/\.,:]?)/g,"")),(void 0===b.month||empty(b.month))&&(reversed_format=reversed_format.replace(/([FMmn](?!\\\\)\s?[\-\/\.,:]?)/g,"")),(void 0===b.day||empty(b.day))&&(reversed_format=reversed_format.replace(/([l|D|d|dS|j|jS|N|w|W|z]{1,2}(?!\\\\)\s?[\-\/\.,:]?)/g,"")),(void 0===b.hour||empty(b.hour))&&(reversed_format=reversed_format.replace(/([HhGg](?!\\\\)\s?[\-\/\.,:]?)/g,"")),(void 0===b.minute||empty(b.minute))&&(reversed_format=reversed_format.replace(/([i](?!\\\\)\s?[\-\/\.,:]?)/g,"")),(void 0===b.second||empty(b.second))&&(reversed_format=reversed_format.replace(/([s](?!\\\\)\s?[\-\/\.,:]?)/g,"")),(void 0===b.timezone||empty(b.timezone))&&(reversed_format=reversed_format.replace(/([TOZPe](?!\\\\)\s?[\-\/\.,:]?)/g,"")),a=reversed_format.split("").reverse().join(""),a=a.replace(/(\(\))/g,""),a=a.replace(/(\[\])/g,""),a=a.replace(/(\|\|)/g,""),a=$.trim(a),a=a.replace(/^([\-\/\.,:\'])/,""),a=a.replace(/([\-\/,:\']$)/,""),a=a.replace(/(\\$)/,""),a=$.trim(a),test=a,test=$.trim(test.replace("(\\\\S{1,3})u","")),empty(test)&&(a=""),a}catch(c){console.log("date_limit_format() - "+c)}}function date_has_time(a){try{var b=!1;return(void 0!==a.hour&&!empty(a.hour)||void 0!==a.minute&&!empty(a.minute)||void 0!==a.second&&!empty(a.second))&&(b=!0),b}catch(c){console.log("date_has_time() - "+c)}}function date_has_date(a){try{var b=!1;return(void 0!==a.year&&!empty(a.year)||void 0!==a.month&&!empty(a.month)||void 0!==a.day&&!empty(a.day))&&(b=!0),b}catch(c){console.log("date_has_date() - "+c)}}function date_field_date(a,b){var c=null,d=$("#"+a).val(),e=-1!=d.indexOf("|"),f=[];return e?f=d.split("|"):f.push(d),d?(!b&&empty(f[0])&&(f[0]=date_yyyy_mm_dd_hh_mm_ss()),date_apple_device()&&offset?c=date_item_adjust_offset(c,offset):date_apple_device()?b?e&&(item_date=new Date(date_apple_cleanse(f[1])),item_date=item_date.getTime()+6e4*item_date.getTimezoneOffset(),c=new Date(item_date)):(item_date=new Date(date_apple_cleanse(f[0])),item_date=item_date.getTime()+6e4*item_date.getTimezoneOffset(),c=new Date(item_date)):c=b?e?new Date(f[1]):new Date:new Date(f[0])):date_apple_device()?(item_date=new Date,item_date=item_date.getTime()+6e4*item_date.getTimezoneOffset(),c=new Date(item_date)):c=new Date,c}function date_popup_open(a,b,c,d,e,f,g){var h=-1!=$(a).attr("id").indexOf("value2"),i=date_field_date(d,h);datePicker.show({date:i,mode:b,minuteInterval:f},function(e){"date"==b?i.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()):"time"==b&&(i.setHours(e.getHours()),i.setMinutes(e.getMinutes()),i.setSeconds(e.getSeconds()));var f=$("#"+d).val(),g=-1!=f.indexOf("|"),j=[];g?j=f.split("|"):j.push(f);var k=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(i));h?j[1]=k:j[0]=k,$("#"+d).val(j.join("|")),$(a).val(date(c,i.getTime()))})}function date_apple_device(){return"undefined"!=typeof device&&"iOS"==device.platform||navigator.vendor&&navigator.vendor.indexOf("Apple")>-1}function date_apple_cleanse(a){return a.replace(/ /g,"T")}function date_military(a){var b=!0;return!a.widget.settings.input_format||-1==a.widget.settings.input_format.indexOf("g")&&-1==a.widget.settings.input_format.indexOf("h")||(b=!1),b}function date_select_onchange(a,b,c,d,e,f){try{var g=-1!=$(a).attr("id").indexOf("value2"),h=date_field_date(b,g),i=$(a).val();switch(c){case"year":h.setYear(i);break;case"month":h.setMonth(i-1);break;case"day":h.setDate(i);break;case"hour":if(d)h.setHours(i);else{var j=h.getHours();"pm"==i?h.getHours()<12?h.setHours(h.getHours()+12):h.setHours(h.getHours()):"am"==i&&h.setHours(h.getHours()-12),i=parseInt(i),i>=0&&j>12?h.setHours(i+12):i>=0&&j<12?h.setHours(i):i>=0&&12==j&&h.setHours(0)}break;case"minute":h.setMinutes(i);break;case"second":h.setSeconds(i)}h.setMinutes(_date_minute_increment_adjust(e,h.getMinutes()));var k=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(h));g?parts[1]=k:parts[0]=k,$("#"+b).val(parts.join("|"))}catch(l){drupalgap_error(l)}}function date_text_onchange(a,b,c,d,e){try{var f=-1!=$(a).attr("id").indexOf("value2"),g=$("#"+b).val(),h=-1!=g.indexOf("|"),i=[];h?i=g.split("|"):i.push(g);var j=$(a).val();f?i[1]=j:i[0]=j,$("#"+b).val(i.join("|"))}catch(k){drupalgap_error(k)}}function _date_minute_increment_adjust(a,b){try{switch(a){case 5:b<5?b=0:b<10?b=5:b<15?b=10:b<20?b=15:b<25?b=20:b<30?b=25:b<35?b=30:b<40?b=35:b<45?b=40:b<50?b=45:b<55?b=50:b<60&&(b=55);break;case 10:b<10?b=0:b<20?b=10:b<30?b=20:b<40?b=30:b<50?b=40:b<60&&(b=50);break;case 15:b<15?b=0:b<30?b=15:b<45?b=30:b<60&&(b=45);break;case 30:b<30?b=0:b<60&&(b=30)}return b}catch(c){console.log("_date_minute_increment_adjust - "+c)}}function date_format_cleanse(a,b){for(grain in b)if(b.hasOwnProperty(grain)){var c=b[grain];if(!c){var d=[];switch(grain){case"year":d=["L","o","Y","y"];break;case"month":d=["F","m","M","n","t"];break;case"day":d=["d","D","j","l","L","N","S","w","z"];break;case"hour":d=[" - ","g:","G:","h:","H:","g","G","h","H"];break;case"minute":d=["i:","i"];break;case"second":d=["s"]}if(d.length)for(var e=0;e<d.length;e++){var f=d[e];a=a.replace(f,"")}}}return a}function date_format_order(a){if(order=[],empty(a))return order;for(i=0;i<=a.length;i++)switch(a.charAt(i)){case"d":case"j":order.push("day");break;case"F":case"M":case"m":case"n":order.push("month");break;case"Y":case"y":order.push("year");break;case"g":case"G":case"h":case"H":order.push("hour");break;case"i":order.push("minute");break;case"s":order.push("second")}return order}function date_item_adjust_offset(a,b){return a=new Date(a.toUTCString()),a=a.getTime()/1e3,a-=parseInt(b),new Date(1e3*a)}function date_time_zones(){return drupalgap.time_zones}function date_get_time_zone(a){return a?date_time_zones()[a]:date_time_zones()[date_site_time_zone_name()]}function date_site_time_zone_name(){return drupalgap.site_settings.date_default_timezone}function date_tz_handling_is_date(a){return a.settings.tz_handling&&"date"==a.settings.tz_handling&&drupalgap.time_zones}function _date_get_item_and_offset(a,b,c,d,e,f){try{var g=null,h=null;if(d&&"value"==c){if(-1!=a[b].value.indexOf("|")){var i=a[b].value.split("|");date_apple_device()?(g=new Date(date_apple_cleanse(i[0])),g=g.getTime()+6e4*g.getTimezoneOffset(),g=new Date(g)):g=new Date(i[0])}else date_apple_device()?(g=new Date(date_apple_cleanse(a[b].value)),g=g.getTime()+6e4*g.getTimezoneOffset(),g=new Date(g)):g=new Date(a[b].value);a[b].item&&a[b].item.offset&&(h=a[b].item.offset)}e&&"value2"==c&&(date_apple_device()?(g=new Date(date_apple_cleanse(a[b].item.value2)),g=g.getTime()+6e4*g.getTimezoneOffset(),g=new Date(g)):g=new Date(a[b].item.value2),a[b].item&&a[b].item.offset2&&(h=a[b].item.offset2)),d||e||g||(g=new Date),date_apple_device()&&h&&(g=date_item_adjust_offset(g,h));var j={item_date:g,offset:h,timezone:null,timezone_db:null};if(date_tz_handling_is_date(f)&&(d||e)&&g){j.timezone=a[b].item.timezone,j.timezone_db=a[b].item.timezone_db;var k=g.valueOf()-1e3*date_get_time_zone()+1e3*h;g=new Date(k),j.item_date=g}return j}catch(l){console.log("_date_get_item_and_offset",l)}}function _date_widget_check_and_set_defaults(a,b,c,d,e){try{var f=!0,g=!0;if(void 0!==a[b].value&&""!=a[b].value||(f=!1),void 0!==a[b].item&&void 0!==a[b].item.value2&&""!=a[b].item.value2||(g=!1),f||""!=a[b].default_value&&a[b].default_value||""==c.settings.default_value||(a[b].default_value=c.settings.default_value),g||empty(d)||""!=a[b].default_value2&&a[b].default_value2||""==c.settings.default_value2||(a[b].default_value2=c.settings.default_value2),!f&&""!=a[b].default_value){switch(a[b].default_value){case"now":var h=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(e));a[b].value=h,a[b].default_value=h,f=!0;break;case"blank":a[b].value="",a[b].default_value="";break;default:console.log("WARNING: date_field_widget_form() - unsupported default value: "+a[b].default_value)}f&&(a[b].item||(a[b].item={}),a[b].item.value=a[b].value)}if(!g&&void 0!==a[b].default_value2&&""!=a[b].default_value2){switch(a[b].default_value2){case"now":var h=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(e));a[b].value2=h,a[b].default_value2=h,g=!0;break;case"same":var h=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(e));a[b].value2=h,a[b].default_value2=h,empty(a[b].value)||(a[b].value+="|"),a[b].value+=a[b].value2,empty(a[b].default_value)||(a[b].default_value+="|"),a[b].default_value+=a[b].default_value2,g=!0;break;case"blank":a[b].value2="",a[b].default_value2="";break;default:console.log("WARNING: date_field_widget_form() - unsupported default value 2: "+a[b].default_value2)}g&&(a[b].item||(a[b].item={}),a[b].item.value2=a[b].value2)}return{value_set:f,value2_set:g}}catch(i){console.log("_date_widget_check_and_set_defaults",i)}}function date_translate(a){var b=new RegExp(date_words.join("|"),"gi");return a.replace(b,function(a){return t(a)})}function date_services_request_pre_postprocess_alter(a,b){"system"==a.service&&"connect"==a.resource&&b.time_zones&&(drupalgap.time_zones=b.time_zones)}function date_assemble_form_state_into_field(a,b,c,d,e,f,g,h,i){try{var j=d.settings.todate,k=void 0!==i.elements[d.field_name][f][g].item;"date_select"==e.widget.type&&date_apple_device()&&(c=date_apple_cleanse(c));var l={},m=["value"];return empty(j)||m.push("value2"),$.each(m,function(a,b){function m(a,c){var h=null;if("value"==b)if(h=new Date(o[0]),k){var j=parseInt(i.elements[d.field_name][f][g].item.offset);j&&(l.offset=j),date_apple_device()&&j?(h=new Date(h.toUTCString()),h=h.getTime()/1e3,h-=parseInt(j),h=new Date(1e3*h)):date_apple_device()&&(h=new Date(date_apple_cleanse(o[0])),h=h.getTime()+6e4*h.getTimezoneOffset(),h=new Date(h))}else date_apple_device()&&j?(h=new Date(h.toUTCString()),h=h.getTime()/1e3,h-=parseInt(j),h=new Date(1e3*h)):date_apple_device()&&(h=new Date(date_apple_cleanse(o[0])),h=h.getTime()+6e4*h.getTimezoneOffset(),h=new Date(h));else if("value2"==b)if(h=new Date(o[1]),k){var m=parseInt(i.elements[d.field_name][f][g].item.offset2);m&&(l.offset2=m),date_apple_device()&&m?(h=new Date(h.toUTCString()),h=h.getTime()/1e3,h-=parseInt(m),h=new Date(1e3*h)):date_apple_device()&&(h=new Date(date_apple_cleanse(o[1])),h=h.getTime()+6e4*h.getTimezoneOffset(),h=new Date(h))}else date_apple_device()&&m?(h=new Date(h.toUTCString()),h=h.getTime()/1e3,h-=parseInt(m),h=new Date(1e3*h)):date_apple_device()&&(h=new Date(date_apple_cleanse(o[1])),h=h.getTime()+6e4*h.getTimezoneOffset(),h=new Date(h));if("date_select"==e.widget.type&&c)switch(a){case"year":l[b].year=h.getFullYear();break;case"month":l[b].month=parseInt(h.getMonth())+1;break;case"day":l[b].day=parseInt(h.getDate());break;case"hour":l[b].hour=parseInt(h.getHours()),date_military(e)||(l[b].hour>=12?(l[b].hour=l[b].hour%12,l[b].ampm="pm"):l[b].ampm="am",0==l[b].hour&&(l[b].hour=12));break;case"minute":l[b].minute=""+parseInt(h.getMinutes()),1==l[b].minute.length&&(l[b].minute="0"+l[b].minute);break;case"second":l[b].second=""+parseInt(h.getSeconds()),1==l[b].second.length&&(l[b].second="0"+l[b].second)}}l[b]={};var n=-1!=c.indexOf("|"),o=[];if(n?o=c.split("|"):o.push(c),date_tz_handling_is_date(d)){var p={timezone:$("#"+i.elements[d.field_name][f][g].id+"-timezone").val()};d.settings.timezone_db&&(p.timezone_db=d.settings.timezone_db),l.timezone=p}if(h.use_key=!1,h.use_delta=!0,"date_select"==e.widget.type)$.each(d.settings.granularity,m);else if("date_popup"==e.widget.type){l[b]={};var q="";"value"==b?q=date_apple_device()?new Date(date_apple_cleanse(o[0])):new Date(o[0]):"value2"==b&&(q=date_apple_device()?new Date(date_apple_cleanse(o[1])):new Date(o[1]),("required"==j||"optional"==j&&"object"==typeof q)&&(l.show_todate=!0));var r=date_format_widget(d,e);if(date_has_date(d.settings.granularity)){var s=JSON.parse(JSON.stringify(d.settings.granularity));s.hour=0,s.minute=0,s.second=0;var t=date_limit_format(r,s);l[b].date=date(t,q.getTime())}if(date_has_time(d.settings.granularity)){var u=JSON.parse(JSON.stringify(d.settings.granularity));u.year=0,u.month=0,u.day=0;var v=date_limit_format(r,u);l[b].time=date(v,q.getTime())}}else{var q="";"value"==b?q=o[0]:"value2"==b&&(q=o[1],("required"==j||"optional"==j&&!empty(q))&&(l.show_todate=!0)),l[b]={date:q}}}),l}catch(n){console.log("date_assemble_form_state_into_field - "+n)}}function theme_datetime(a){try{var b="";a.attributes.type="hidden",b+="<input "+drupalgap_attributes(a.attributes)+"/>";var c=a.field_info_instance.widget.type,d="theme_"+c;if(function_exists(d)){b+=window[d].call(null,a)}else{var e="WARNING: theme_datetime() - unsupported widget type! ("+c+")";console.log(e)}return b}catch(f){console.log("theme_datetime - "+f)}}function theme_date_select(a){try{return theme("select",a)}catch(b){console.log("theme_date_select - "+b)}}function theme_date_label(a){try{return"<div "+drupalgap_attributes(a.attributes)+"><strong>"+a.title+"</strong></div>"}catch(b){console.log("theme_date_label - "+b)}}function date_views_exposed_filter(a,b,c,d,e){try{d.options.expose.use_operator&&(a.elements[d.options.expose.operator]={title:t("Operator"),type:"select",options:{"&lt;":t("Is less than"),"&lt;=":t("Is less than or equal to"),"=":t("Is equal to"),"!=":t("Is not equal to"),"&gt;=":t("Is greater than or equal to"),"&gt;":t("Is greater than"),between:t("Is between"),"not between":t("Is not between"),empty:t("Is empty (NULL)"),"not empty":t("Is not empty (NOT NULL)"),regular_expression:t("Regular expression"),contains:t("Contains")}}),c.type="hidden",c.attributes={name:d.definition.field};var f=!1,g=!1,h=new Date,i=_date_get_item_and_offset(w,x,"value",f,g,e),j=i.item_date,k=i.offset,l=!0,m=null,n=null,o=null,p=null,q=null,r=null,s=null,u={widget:{settings:{year_range:d.options.year_range}}},v=["second","minute","hour","day","month","year"];$.each(e.settings.granularity,function(a,b){if(b&&v.indexOf(a)>=v.indexOf(d.options.granularity)){var e=c.options.attributes.id;e+="-"+a;var f={id:e,onchange:"date_select_onchange(this, '"+c.options.attributes.id+"', '"+a+"', "+l+", "+1+", "+k+")"};switch(a){case"year":m=_date_grain_widget_year(h,u,f);break;case"month":n=_date_grain_widget_month(h,u,f);break;case"day":o=_date_grain_widget_day(h,u,f);break;case"hour":if(p=_date_grain_widget_hour(h,u,f,!1,!1,null,l),!l){var g=f.onchange.replace(a,"ampm")+"; this.date_ampm_old_value = this.value;",i=parseInt(j.getHours())<12?"am":"pm";s={type:"select",attributes:{id:f.id.replace(a,"ampm"),onclick:g,date_ampm_original_value:i},value:i,options:{am:"am",pm:"pm"}}}break;case"minute":q=_date_grain_widget_minute(h,u,f,!1,!1,null,!1,1);break;case"second":r=_date_grain_widget_second(h,u,f);break;default:console.log("WARNING: date_field_widget_form() - unsupported grain! ("+a+")")}}});var w={0:c},x=0;_date_grain_widgets_ux_wrap(w,x,m,n,o,p,q,r,s),c=w[0],c.default_value=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(h)),c.value_callback="date_views_exposed_filter_value",a.submit.unshift("date_views_exposed_filter_submit"),void 0===a.rename_elements&&(a.rename_elements={}),a.rename_elements[c.attributes.name]=c.attributes.name+"[value][date]"}catch(y){console.log("date_views_exposed_filter - "+y)}}function date_views_exposed_filter_submit(a,b){try{void 0!==a.rename_elements&&$.each(a.rename_elements,function(a,c){b.values[c]=b.values[a],delete b.values[a]})}catch(c){console.log("date_views_exposed_filter_submit - "+c)}}function date_views_exposed_filter_value(a,b){try{switch(b.filter.options.granularity){case"year":var c=4;break;case"month":var c=7;break;case"day":var c=10;break;case"hour":var c=13;break;case"minute":var c=16;break;case"second":default:var c=19}return $("#"+a).val().substr(0,c)}catch(d){console.log("date_views_exposed_filter_value - "+d)}}var date_words=["January","February","March","April","May","June","July","August","September","October","November","December","Sun\\b","Mon\\b","Tue\\b","Wed\\b","Thu\\b","Fri\\b","Sat\\b","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];